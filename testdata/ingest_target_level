define
----

# An empty LSM ingests into the bottom level.
target
a-b
----
6

define
L5
  b.SET.1:1
  c.SET.2:2
----
5:
  000004:[b#1,SET-c#2,SET]

target
a-b
b-c
c-d
a-aa
d-e
bb-bb
----
4
4
4
6
6
6

define
L0
  b.SET.3:3
  e.SET.4:4
L0
  d.SET.5:5
  f.SET.6:6
L0
  x.SET.7:7
  y.SET.8:8
L3
  g.SET.1:1
  h.SET.2:2
----
0.1:
  000005:[d#5,SET-f#6,SET]
0.0:
  000004:[b#3,SET-e#4,SET]
  000006:[x#7,SET-y#8,SET]
3:
  000007:[g#1,SET-h#2,SET]

target
b-c
d-e
g-m
i-m
c-c
----
0
0
2
6
6

define
L5
  a.SET.4:4
L5
  c.SET.3:3
L6
  a.SET.2:2
L6
  c.SET.1:1
----
5:
  000004:[a#4,SET-a#4,SET]
  000005:[c#3,SET-c#3,SET]
6:
  000006:[a#2,SET-a#2,SET]
  000007:[c#1,SET-c#1,SET]

target
b-b
----
6

define
L5
  a.SET.4:4
L5
  c.SET.3:3
L6
  a.SET.2:2
L6
  c.SET.1:1
  compact:a-c
----
5:
  000004:[a#4,SET-a#4,SET]
  000005:[c#3,SET-c#3,SET]
6:
  000006:[a#2,SET-a#2,SET]
  000007:[c#1,SET-c#1,SET]

target
b-b
----
5

define
L0
  c.SET.4:4
  d.SET.3:3
  d.RANGEDEL.2:g
L2
  a.RANGEDEL.1:g
----
0.0:
  000004:[c#4,SET-g#72057594037927935,RANGEDEL]
2:
  000005:[a#1,RANGEDEL-g#72057594037927935,RANGEDEL]

target
cc-cc
c-c
g-g
d-d
e-e
a-a
----
1
0
6
0
0
1
