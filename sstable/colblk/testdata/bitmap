build
10101011100011100
----
10101011100011100
Binary representation:
00-08: b 1101010101110001000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

successor indexes=(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)
----
bitmap.Successor(0) = 0
bitmap.Successor(1) = 2
bitmap.Successor(2) = 2
bitmap.Successor(3) = 4
bitmap.Successor(4) = 4
bitmap.Successor(5) = 6
bitmap.Successor(6) = 6
bitmap.Successor(7) = 7
bitmap.Successor(8) = 8
bitmap.Successor(9) = 12
bitmap.Successor(10) = 12
bitmap.Successor(11) = 12
bitmap.Successor(12) = 12
bitmap.Successor(13) = 13
bitmap.Successor(14) = 14
bitmap.Successor(15) = 17
bitmap.Successor(16) = 17

predecessor indexes=(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)
----
bitmap.Predecessor(0) = 0
bitmap.Predecessor(1) = 0
bitmap.Predecessor(2) = 2
bitmap.Predecessor(3) = 2
bitmap.Predecessor(4) = 4
bitmap.Predecessor(5) = 4
bitmap.Predecessor(6) = 6
bitmap.Predecessor(7) = 7
bitmap.Predecessor(8) = 8
bitmap.Predecessor(9) = 8
bitmap.Predecessor(10) = 8
bitmap.Predecessor(11) = 8
bitmap.Predecessor(12) = 12
bitmap.Predecessor(13) = 13
bitmap.Predecessor(14) = 14
bitmap.Predecessor(15) = 14
bitmap.Predecessor(16) = 14

# Test calling Invert() before finishing.

build invert
10101011100011100
----
01010100011100011
Binary representation:
00-08: b 0010101010001110000000010000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63


build
1
----
1
Binary representation:
00-08: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# Test sparseness; relying on the tailing bits being implicitly zeroed.

build rows=512
1
----
1000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
Binary representation:
00-08: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 1
16-24: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 2
24-32: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 3
32-40: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 4
40-48: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 5
48-56: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 6
56-64: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 7
64-72: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

build invert
1
----
0
Binary representation:
00-08: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# Test sparseness with inversion, relying on the trailing bits being implicitly
# set to one.

build invert rows=512
1
----
0111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
Binary representation:
00-08: b 1111111011111111111111111111111111111111111111111111111111111111 # bitmap word 0
08-16: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 1
16-24: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 2
24-32: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 3
32-40: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 4
40-48: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 5
48-56: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 6
56-64: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 7
64-72: b 1111111100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# 32-bits wide

build
1010101010111111111110000001110
----
1010101010111111111110000001110
Binary representation:
00-08: b 0101010111111101000111110011100000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# 33-bits wide

build
10101010101111111111100000011101
----
10101010101111111111100000011101
Binary representation:
00-08: b 0101010111111101000111111011100000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# 64-bits wide

build
1010101010111111111110000001110101010101011111111111000000111011
----
1010101010111111111110000001110101010101011111111111000000111011
Binary representation:
00-08: b 0101010111111101000111111011100010101010111111100000111111011100 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# 63-bits wide

build
101010101011111111111000000111010101010101111111111100000011101
----
101010101011111111111000000111010101010101111111111100000011101
Binary representation:
00-08: b 0101010111111101000111111011100010101010111111100000111101011100 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# 65-bits wide

build
1010101010111111111110000001110101010101011111111111000000111011
1
----
1010101010111111111110000001110101010101011111111111000000111011
1
Binary representation:
00-08: b 0101010111111101000111111011100010101010111111100000111111011100 # bitmap word 0
08-16: b 0000000100000000000000000000000000000000000000000000000000000000 # bitmap word 1
16-24: b 0000001100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

build
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
----
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
Binary representation:
00-08: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 0
08-16: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 1
16-24: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 2
24-32: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 3
32-40: b 1111111111111111111111111111111111111111111111111111111111111111 # bitmap word 4
40-48: b 0001111100000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

build
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
----
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
Binary representation:
00-08: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 1
16-24: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 2
24-32: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 3
32-40: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 4
40-48: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

build
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000001
----
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000001
Binary representation:
00-08: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 1
16-24: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 2
24-32: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 3
32-40: b 0000000000000000000000000000000000000000000000000000000010000000 # bitmap word 4
40-48: b 0001000000000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63

# Write out fewer rows than we set. The bitmap summary should reflect the
# truncated view of the bitmap.

build rows=192
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000111000000000000000000000000000000000000000000000000000
----
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
Binary representation:
00-08: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 0
08-16: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 1
16-24: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap word 2
24-32: b 0000000000000000000000000000000000000000000000000000000000000000 # bitmap summary word 0-63
