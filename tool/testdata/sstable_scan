sstable scan
--start=arm
--end=aside
../sstable/testdata/h.sst
----
h.sst
arm#0,SET [32]
armed#0,SET [32]
armour#0,SET [31]
arms#0,SET [32]
arrant#0,SET [31]
art#0,SET [36]
artery#0,SET [31]
article#0,SET [31]
articles#0,SET [31]
as#0,SET [3536]

sstable scan
--end=abused
../sstable/testdata/h.sst
----
h.sst
a-a#0,RANGEDEL
a#0,SET [3937]
aboard#0,SET [32]
about#0,SET [32]
above#0,SET [31]
abroad#0,SET [31]
absurd#0,SET [31]

sstable scan
--start=you
../sstable/testdata/h.sst
----
h.sst
you#0,SET [313130]
young#0,SET [36]
your#0,SET [3439]
yourself#0,SET [37]
youth#0,SET [35]

sstable scan
--key=%x
--value=null
--start=you
../sstable/testdata/h.sst
----
h.sst
796f75#0,SET
796f756e67#0,SET
796f7572#0,SET
796f757273656c66#0,SET
796f757468#0,SET

sstable scan
--key=%q
--value=null
--start=hex:796f75
--end=raw:yourself
../sstable/testdata/h.sst
----
h.sst
"you"#0,SET
"young"#0,SET
"your"#0,SET

sstable scan
--key=null
--value=[%x]
--start=hex:796f75
--end=raw:yourself
../sstable/testdata/h.sst
----
h.sst
[313130]
[36]
[3439]

sstable scan
--key=pretty
--value=[%x]
--start=hex:796f75
--end=raw:yourself
../sstable/testdata/h.sst
----
h.sst
you#0,SET [313130]
young#0,SET [36]
your#0,SET [3439]

sstable scan
--key=pretty
--value=[%x]
--start=hex:796f75
--end=raw:yourself
../sstable/testdata/h.sst
----
h.sst
you#0,SET [313130]
young#0,SET [36]
your#0,SET [3439]

sstable scan
--key=pretty
--value=pretty
--start=hex:796f75
--end=raw:yourself
../sstable/testdata/h.sst
----
h.sst
you#0,SET 110
young#0,SET 6
your#0,SET 49

sstable scan
--key=pretty:test-comparer
--value=pretty:test-comparer
--start=hex:796f75
--end=raw:yourself
../sstable/testdata/h.sst
----
h.sst
test formatter: you#0,SET test value formatter: 110
test formatter: young#0,SET test value formatter: 6
test formatter: your#0,SET test value formatter: 49

# Start and end scan keys lie within range tombstones.
sstable scan
--start=beards
--end=carrying
../sstable/testdata/h.sst
----
h.sst
beard-bearers#0,RANGEDEL
bearers#0,SET [31]
bears#0,SET [31]
beast#0,SET [32]
beating#0,SET [31]
beauty#0,SET [31]
beaver#0,SET [31]
beckons#0,SET [32]
bed#0,SET [34]
been#0,SET [34]
beetles#0,SET [31]
befitted#0,SET [31]
before#0,SET [36]
beg#0,SET [31]
beguile#0,SET [31]
behold#0,SET [31]
behoves#0,SET [31]
being#0,SET [34]
belief#0,SET [31]
believe#0,SET [36]
bell#0,SET [31]
bend#0,SET [32]
beneath#0,SET [35]
benefit#0,SET [31]
bernardo#0,SET [3330]
beseech#0,SET [32]
besmirch#0,SET [31]
best#0,SET [35]
beteem#0,SET [31]
bethought#0,SET [31]
better#0,SET [32]
between#0,SET [32]
beware#0,SET [32]
beyond#0,SET [31]
bid#0,SET [32]
bird#0,SET [32]
birth#0,SET [33]
bites#0,SET [31]
bitter#0,SET [31]
black#0,SET [31]
blast#0,SET [31]
blastments#0,SET [31]
blasts#0,SET [31]
blazes#0,SET [31]
blazon#0,SET [31]
blessing#0,SET [33]
blood#0,SET [37]
blossoms#0,SET [31]
blows#0,SET [31]
bodes#0,SET [31]
body#0,SET [35]
bonds#0,SET [31]
bones#0,SET [31]
book#0,SET [31]
books#0,SET [31]
born#0,SET [32]
borrower#0,SET [31]
borrowing#0,SET [31]
bosom#0,SET [31]
both#0,SET [33]
bound#0,SET [32]
bounteous#0,SET [31]
bow#0,SET [31]
boy#0,SET [32]
brain#0,SET [32]
bray#0,SET [31]
brazen#0,SET [31]
breach#0,SET [31]
break#0,SET [33]
breaking#0,SET [31]
breath#0,SET [31]
breathing#0,SET [31]
brief#0,SET [31]
bring#0,SET [31]
brokers#0,SET [31]
brother#0,SET [36]
brow#0,SET [31]
bruit#0,SET [31]
bulk#0,SET [31]
buried#0,SET [31]
burns#0,SET [32]
burnt#0,SET [31]
burst#0,SET [32]
business#0,SET [34]
but#0,SET [3538]
buttons#0,SET [31]
buy#0,SET [31]
by#0,SET [3331]
call#0,SET [34]
calumnious#0,SET [31]
came#0,SET [32]
can#0,SET [35]
canker#0,SET [31]
cannon#0,SET [32]
cannot#0,SET [33]
canon#0,SET [31]
canonized#0,SET [31]
canst#0,SET [32]
cap#0,SET [31]
carefully#0,SET [31]
carriage-carve#0,RANGEDEL
carriage#0,SET [31]

# Start scan key lies on range tombstone end key.
sstable scan
--start=bearers
--end=bears
../sstable/testdata/h.sst
----
h.sst
bearers#0,SET [31]

# End scan key lies on range tombstone start key.
sstable scan
--start=bear
--end=beard
../sstable/testdata/h.sst
----
h.sst
bear#0,SET [35]

# Count that only includes point records.
sstable scan
--start=armed
--count=3
../sstable/testdata/h.sst
----
h.sst
armed#0,SET [32]
armour#0,SET [31]
arms#0,SET [32]

# Count that includes point records and range tombstones.
sstable scan
--start=beards
--count=2
../sstable/testdata/h.sst
----
h.sst
beard-bearers#0,RANGEDEL
bearers#0,SET [31]

sstable scan
testdata/out-of-order.sst
----
out-of-order.sst
a#0,SET []
c#0,SET []
b#0,SET []
    WARNING: OUT OF ORDER KEYS!

sstable scan
--filter=arms
../sstable/testdata/h.sst
----
h.sst: arms#0,SET [32]

sstable scan
--filter=bear
../sstable/testdata/h.sst
----
h.sst: bear#0,SET [35]
h.sst: beard-bearers#0,RANGEDEL
h.sst: beard#0,SET [31]
h.sst: bearers#0,SET [31]
h.sst: bears#0,SET [31]

sstable scan
--filter=beards
../sstable/testdata/h.sst
----
h.sst: beard-bearers#0,RANGEDEL

sstable scan
--filter=beard
../sstable/testdata/
----
testdata/h.no-compression.sst: beard-bearers#0,RANGEDEL
testdata/h.no-compression.sst: beard#0,SET [31]
testdata/h.no-compression.two_level_index.sst: beard-bearers#0,RANGEDEL
testdata/h.no-compression.two_level_index.sst: beard#0,SET [31]
testdata/h.sst: beard-bearers#0,RANGEDEL
testdata/h.sst: beard#0,SET [31]
testdata/h.table-bloom.no-compression.prefix_extractor.no_whole_key_filter.sst: beard-bearers#0,RANGEDEL
testdata/h.table-bloom.no-compression.prefix_extractor.no_whole_key_filter.sst: beard#0,SET [31]
testdata/h.table-bloom.no-compression.sst: beard-bearers#0,RANGEDEL
testdata/h.table-bloom.no-compression.sst: beard#0,SET [31]
testdata/h.table-bloom.sst: beard-bearers#0,RANGEDEL
testdata/h.table-bloom.sst: beard#0,SET [31]
testdata/h.zstd-compression.sst: beard-bearers#0,RANGEDEL
testdata/h.zstd-compression.sst: beard#0,SET [31]

sstable scan
--filter=beard
--start=boar
../sstable/testdata/h.sst
----

sstable scan
./testdata/mixed/000005.sst
----
000005.sst
a@1#10,SET []
b@1#11,SET []
c@1#12,SET []
d@1#13,SET []
e@1#14,SET []
f@1#15,SET []
g@1#16,SET []
h@1#17,SET []
i@1#18,SET []
j@1#19,SET []
k@1#20,SET []
l@1#21,SET []
m@1#22,SET []
n@1#23,SET []
o@1#24,SET []
p@1#25,SET []
q@1#26,SET []
r@1#27,SET []
s@1#28,SET []
t@1#29,SET []
u@1#30,SET []
v@1#31,SET []
w@1#32,SET []
x@1#33,SET []
y@1#34,SET []
z@1#35,SET []
[a-b):
  #38,RANGEKEYDEL
[b-z):
  #37,RANGEKEYUNSET: @2
  #36,RANGEKEYSET: @1 []

sstable scan
--start=b
--end=e
./testdata/mixed/000005.sst
----
000005.sst
b@1#11,SET []
c@1#12,SET []
d@1#13,SET []
[b-z):
  #37,RANGEKEYUNSET: @2
  #36,RANGEKEYSET: @1 []

sstable scan
--filter=a
./testdata/mixed/000005.sst
----
000005.sst: a@1#10,SET []
000005.sst: [a-b):
  #38,RANGEKEYDEL

sstable scan
--filter=b
--start=b
--end=d
./testdata/mixed/000005.sst
----
000005.sst: b@1#11,SET []
000005.sst: [b-z):
  #37,RANGEKEYUNSET: @2
  #36,RANGEKEYSET: @1 []

sstable scan
./testdata/cr-schema.sst
----
cr-schema.sst
tcestilr@3176.073933065,0#0,SET [b67f9deccb5f22c70c23575ae00e9156]
tcestilr@3155.610170870,0#0,SET [d8094571a876976dd01ba2a5026a898e]
tcestilr@2257.175610483,0#0,SET [9e3a0669c89f7d96c254f7571dca3d61]
tcestilr@2027.979535545,0#0,SET [db22bfa0566709c2cf6488e4376e89a7]
tcestilr@1999.232216345,0#0,SET [4e224bcbe873fe8810f9cf81873ba504]
tcestilr@1961.730565157,0#0,SET [c0a4b04a2bbf7fbad03d82eaa070366f]
tcestilr@112.569705592,0#0,SET [9b9fefa63bd80a0a8bf551d6133358bf]
tcfrjshd@552.255371146,0#0,SET [88d54ae6ffa7def957dcadc876befd26]
tchgdrgj#0,SET [4f4d615f39482fcf4ae7d15890e1611e]
tchiarcd@999.614877036,0#0,SET [395ad94a5a629f21bd826f0b61a0626d]
tcjmfhds@155.282098007,0#0,SET [e859c0e60dbfef6c88f329765525d7a5]
tclaldso@2918.844225402,0#0,SET [53114b04080ac9bf8ab0c9e4dbb0eb7f]
tcnnriss@3485.299789445,0#0,SET [e6339c44d0d9daeea35c04449f3081a9]
tcnnriss@335.378301115,0#0,SET [3a6feab777e1d9d0e0e73c5b6126ec11]
tcpchosd#0,SET [95f99384c24d1320f03f33d58f54c6b7]
tcpchosd@2786.903868370,0#0,SET [4a3ba1f63afdf06e061257f2a2277b66]
tcpchosd@2210.960065030,0#0,SET [0d945d694573ff74244235cc405d3bde]
tcpchosd@2073.542476344,0#0,SET [c3009bd907c208e4b2f8a721403502ee]
tcpchosd@82.858934535,594919620#0,SET [0bac1470fab6a1e270410dda5f39f31d]
tcrsfsqc@1366.233420574,0#0,SET [1b22f2128e75f0433e8eda52c41872e6]

sstable scan
./testdata/find-db-val-sep
--blob-mode=print
----
find-db-val-sep/000005.sst
aaa\x00#10,SET [(f0,blk0,id0,len5)]
bbb\x00#11,SET [(f0,blk0,id1,len3)]
ccc\x00#12,SET [(f0,blk0,id2,len10)]
ddd\x00#13,SET [6]

sstable scan
--filter=armed
--blob-mode=print
../sstable/testdata/h.sst
----
h.sst: armed#0,SET [2]

sstable scan
./testdata/find-db-val-sep/000005.sst
--blob-mode=load
----
when --blob-mode=load is specified, the path to a directory containing a manifest and blob file must be provided as the last argument

sstable scan
./testdata/find-db-val-sep/000005.sst
./testdata/find-db-val-sep
--blob-mode=load
----
000005.sst
aaa\x00#10,SET [yuumi]
bbb\x00#11,SET [mai]
ccc\x00#12,SET [poiandyaya]
ddd\x00#13,SET [6]
